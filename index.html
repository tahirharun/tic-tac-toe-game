<!DOCTYPE html>
<html>
<head>
    <title>Tic-Tac-Toe</title>
    <style>
        body {
            font-family: Arial; 
            text-align: center; 
            margin-top: 50px; 
            background: linear-gradient(135deg, #ff9a9e, #fad0c4);
            transition: background 0.5s;
        }
        h1 { color: #fff; text-shadow: 2px 2px #333; }
        .board {
            display: grid; 
            grid-template-columns: repeat(3, 100px); 
            grid-gap: 5px; 
            justify-content: center; 
            margin-bottom: 20px; 
        }
        .cell {
            width: 100px; 
            height: 100px; 
            font-size: 50px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border: 3px solid #fff; 
            cursor: pointer; 
            transition: background 0.3s, transform 0.2s; 
            border-radius: 10px;
            background: rgba(255,255,255,0.3);
        }
        .cell:hover {
            background: rgba(255,255,255,0.6);
            transform: scale(1.1);
        }
        .x { color: #ff4500; font-weight: bold; text-shadow: 1px 1px #000; }
        .o { color: #1e90ff; font-weight: bold; text-shadow: 1px 1px #000; }
        button {
            padding: 10px 25px; 
            font-size: 18px; 
            cursor: pointer; 
            border: none; 
            border-radius: 10px; 
            margin: 10px; 
            background: linear-gradient(45deg, #fbc2eb, #a6c1ee);
            color: #fff;
            font-weight: bold;
            transition: transform 0.2s, background 0.3s;
        }
        button:hover { transform: scale(1.1); background: linear-gradient(45deg, #a1c4fd, #c2e9fb); }
        #message { font-size: 24px; font-weight: bold; color: #fff; text-shadow: 1px 1px #333; }
    </style>
</head>
<body>
    <h1>Tic-Tac-Toe ðŸŽ®</h1>
    <div id="mode">
        <h2 style="color:#fff;">Choose Mode:</h2>
        <button onclick="chooseMode('pvp')">Player vs Player</button>
        <button onclick="chooseMode('pvc')">Player vs AI</button>
    </div>
    
    <div id="choose" style="display:none;">
        <h2 style="color:#fff;">Choose your side:</h2>
        <button onclick="startGame('X')">X</button>
        <button onclick="startGame('O')">O</button>
    </div>
    
    <div class="board" id="board" style="display:none;"></div>
    <h2 id="message"></h2>
    <button onclick="resetGame()" style="display:none;" id="resetBtn">Reset Game</button>

    <script>
        const board = Array(9).fill(null);
        const boardDiv = document.getElementById('board');
        const message = document.getElementById('message');
        const chooseDiv = document.getElementById('choose');
        const resetBtn = document.getElementById('resetBtn');
        const modeDiv = document.getElementById('mode');

        let player, ai, currentTurn, mode;

        function chooseMode(selectedMode) {
            mode = selectedMode;
            modeDiv.style.display = 'none';
            if(mode === 'pvc') {
                chooseDiv.style.display = 'block';
            } else {
                // Player vs Player: set initial turn to X
                startGamePvP();
            }
        }

        function startGame(side) {
            player = side;
            ai = player === 'X' ? 'O' : 'X';
            chooseDiv.style.display = 'none';
            boardDiv.style.display = 'grid';
            resetBtn.style.display = 'inline-block';
            message.textContent = '';
            for(let i=0;i<board.length;i++) board[i] = null;
            renderBoard();

            currentTurn = ai === 'X' ? 'ai' : 'player';
            if(currentTurn === 'ai') {
                aiMove();
                currentTurn = 'player';
                renderBoard();
            }
        }

        function startGamePvP() {
            player = 'X';
            currentTurn = 'player'; // 'player' is X's turn
            boardDiv.style.display = 'grid';
            resetBtn.style.display = 'inline-block';
            message.textContent = '';
            for(let i=0;i<board.length;i++) board[i] = null;
            renderBoard();
        }

        function checkWin(char) {
            const winCombos = [
                [0,1,2],[3,4,5],[6,7,8],
                [0,3,6],[1,4,7],[2,5,8],
                [0,4,8],[2,4,6]
            ];
            return winCombos.some(combo => combo.every(i => board[i] === char));
        }

        function checkDraw() {
            return board.every(cell => cell !== null);
        }

        function aiMove() {
            let move = findBestMove(ai);
            if(move === null) move = findBestMove(player);
            if(move === null && board[4] === null) move = 4; 
            if(move === null) { 
                const corners = [0,2,6,8].filter(i => board[i] === null);
                if(corners.length > 0) move = corners[Math.floor(Math.random()*corners.length)];
            }
            if(move === null) { 
                const sides = [1,3,5,7].filter(i => board[i] === null);
                if(sides.length > 0) move = sides[Math.floor(Math.random()*sides.length)];
            }
            if(move !== null) board[move] = ai;
        }

        function findBestMove(char) {
            for(let i=0;i<board.length;i++) {
                if(board[i] === null) {
                    board[i] = char;
                    if(checkWin(char)) {
                        board[i] = null;
                        return i;
                    }
                    board[i] = null;
                }
            }
            return null;
        }

        function handleClick(index) {
            if(board[index] || message.textContent) return;

            if(mode === 'pvp') {
                const char = currentTurn === 'player' ? 'X' : 'O';
                board[index] = char;
                renderBoard();
                if(checkWin(char)) {
                    message.textContent = `${char} wins!`;
                    return;
                }
                if(checkDraw()) {
                    message.textContent = "It's a draw!";
                    return;
                }
                currentTurn = currentTurn === 'player' ? 'ai' : 'player'; 
            } else if(mode === 'pvc') {
                if(currentTurn !== 'player') return;
                board[index] = player;
                renderBoard();
                if(checkWin(player)) {
                    message.textContent = "You win! ";
                    return;
                }
                if(checkDraw()) {
                    message.textContent = "It's a draw!";
                    return;
                }

                currentTurn = 'ai';
                aiMove();
                renderBoard();
                currentTurn = 'player';
                if(checkWin(ai)) {
                    message.textContent = "AI wins!";
                    return;
                }
                if(checkDraw()) {
                    message.textContent = "It's a draw!";
                }
            }
        }

        function renderBoard() {
            boardDiv.innerHTML = '';
            board.forEach((cell,i) => {
                const div = document.createElement('div');
                div.className = 'cell';
                if(cell) div.classList.add(cell.toLowerCase());
                div.textContent = cell;
                div.addEventListener('click',()=>handleClick(i));
                boardDiv.appendChild(div);
            });
        }

        function resetGame() {
            for(let i=0;i<board.length;i++) board[i] = null;
            message.textContent = '';
            modeDiv.style.display = 'block';
            chooseDiv.style.display = 'none';
            boardDiv.style.display = 'none';
            resetBtn.style.display = 'none';
        }
    </script>
</body>
</html>